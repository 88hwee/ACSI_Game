<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>History Typing Drill</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  background:#020617;
  color:#e5e7eb;
  font-family:Consolas, monospace;
  overflow:hidden;
}
header{
  height:70px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 18px;
  background:#0f172a;
  border-bottom:2px solid #7c3aed;
}
h1{font-size:18px;margin:0}
.stat small{
  display:block;
  font-size:10px;
  color:#94a3b8;
}
.stat div{
  font-size:24px;
  font-weight:800;
}
#canvas{
  position:relative;
  height:calc(100vh - 140px);
}
.word{
  position:absolute;
  padding:8px 14px;
  border-radius:12px;
  background:#020617;
  border:2px solid #38bdf8;
  font-weight:700;
  white-space:nowrap;
}
footer{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  height:70px;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#020617;
  border-top:2px solid #334155;
}
input{
  width:90%;
  max-width:820px;
  font-size:22px;
  padding:12px 16px;
  border-radius:14px;
  background:#020617;
  color:white;
  border:2px solid #334155;
}
input:focus{
  outline:none;
  border-color:#f43f5e;
}
.overlay{
  position:absolute;
  inset:0;
  background:rgba(2,6,23,.95);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:50;
}
.card{
  background:#0f172a;
  border:2px solid #7c3aed;
  border-radius:22px;
  padding:26px;
  text-align:center;
  max-width:700px;
  width:90%;
}
.btn{
  background:linear-gradient(90deg,#d946ef,#7c3aed);
  border:none;
  color:white;
  font-weight:900;
  padding:14px 26px;
  border-radius:16px;
  cursor:pointer;
  margin-top:16px;
}
.big{
  font-size:44px;
  font-weight:900;
}
.notice{
  position:absolute;
  top:42%;
  left:50%;
  transform:translate(-50%,-50%);
  font-size:40px;
  font-weight:900;
  text-align:center;
  text-shadow:0 0 18px currentColor;
  pointer-events:none;
  z-index:100;
}
.notice small{
  display:block;
  font-size:16px;
  font-weight:600;
  margin-top:6px;
  color:#e5e7eb;
}
</style>
</head>

<body>

<header>
  <div class="stat"><small>SCORE</small><div id="score">0</div></div>
  <h1>History Typing Drill (Press Enter)</h1>
  <div class="stat"><small>TIME</small><div id="time">03:00</div></div>
</header>

<main id="canvas">

<div id="start" class="overlay">
  <div class="card">
    <h2>Standard mode</h2>
    <p>
      Type normally. Capitalise names properly.<br>
      Press <b>Enter</b> to submit each word.
    </p>
    <p><b>Aim: 40–80 words per minute</b></p>
    <button class="btn" onclick="startGame()">Start</button>
  </div>
</div>

<div id="end" class="overlay" style="display:none">
  <div class="card">
    <h2>Typing report</h2>
    <div class="big" id="finalWpm">0</div>
    <p id="finalMsg"></p>
    <button class="btn" onclick="location.reload()">Retry</button>
  </div>
</div>

</main>

<footer>
  <input id="input" disabled placeholder="Type here, then press Enter">
</footer>

<script>
/* ===== WORD LIST ===== */
/* Names: first letter capital only */
/* Everything else: normal sentence case */
const WORDS = [
  // People
  "Hitler","Stalin","Mussolini","Hindenburg",
  "Stresemann","Goebbels","Ernst Roehm","Wilson",

  // Countries / organisations
  "Germany","United States","Soviet Union","League of Nations",

  // Concepts / events
  "November criminals","War guilt clause","Treaty of versailles",
  "Weimar republic","Great depression","Hyperinflation",
  "Munich agreement","Appeasement","Conscription","Disarmament",
  "Autarky","Propaganda","Militarism","Nationalism",
  "Fascism","Communism",

  // Places
  "Rhineland","Sudetenland","Upper silesia","Danzig",
  "Poland","Austria","Manchuria","Abyssinia"
];

/* ===== FEEDBACK POOLS ===== */
const PRAISE = ["Sigma!","Nice!","Good control","Clean typing"];
const WARN = ["Oops!","Aiyoh!!","Be careful","You are cooked"];

const canvas = document.getElementById("canvas");
const input = document.getElementById("input");
const scoreEl = document.getElementById("score");
const timeEl = document.getElementById("time");

let words=[];
let score=0;
let timeLeft=180;
let active=false;
let correctChars=0;
let spawnRate=2200;
let lastSpawn=0;

let correctStreak=0;
let mistakeStreak=0;

/* ===== GAME START ===== */
function startGame(){
  document.getElementById("start").style.display="none";
  input.disabled=false;
  input.focus();
  active=true;
  spawnWord();
  requestAnimationFrame(loop);

  setInterval(()=>{
    if(!active) return;
    timeLeft--;
    updateTime();
    if(timeLeft<=0) endGame();
  },1000);
}

function updateTime(){
  const m=Math.floor(timeLeft/60);
  const s=timeLeft%60;
  timeEl.textContent=
    `${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`;
}

/* ===== WORD SPAWN ===== */
function spawnWord(){
  const text=WORDS[Math.floor(Math.random()*WORDS.length)];
  const el=document.createElement("div");
  el.className="word";
  el.textContent=text;

  el.style.left=Math.random()*(canvas.clientWidth-220)+"px";
  el.style.top="-40px";
  canvas.appendChild(el);

  words.push({
    el,
    text,
    y:-40,
    speed:(0.8+Math.random()*0.4)*0.9 // 10% slower
  });
}

function loop(ts){
  if(!active) return;

  if(ts-lastSpawn>spawnRate){
    spawnWord();
    lastSpawn=ts;
  }

  for(let i=words.length-1;i>=0;i--){
    const w=words[i];
    w.y+=w.speed;
    w.el.style.transform=`translateY(${w.y}px)`;
    if(w.y>canvas.clientHeight){
      w.el.remove();
      words.splice(i,1);
    }
  }
  requestAnimationFrame(loop);
}

/* ===== INPUT ===== */
input.addEventListener("keydown",e=>{
  if(e.key!=="Enter") return;
  const typed=input.value.trim();
  if(!typed) return;

  for(let i=0;i<words.length;i++){
    if(typed===words[i].text){
      handleCorrect(words[i],i);
      input.value="";
      return;
    }
  }

  handleMistake();
  input.value="";
});

/* ===== FEEDBACK LOGIC ===== */
function handleCorrect(word,i){
  score+=10;
  scoreEl.textContent=score;
  correctChars+=word.text.length;

  correctStreak++;
  mistakeStreak=0;

  if(Math.random()<0.35){
    showNotice(
      PRAISE[Math.floor(Math.random()*PRAISE.length)],
      "#22c55e"
    );
  }

  word.el.remove();
  words.splice(i,1);
}

function handleMistake(){
  mistakeStreak++;
  correctStreak=0;

  if(Math.random()<0.35){
    showNotice(
      WARN[Math.floor(Math.random()*WARN.length)],
      "#f59e0b"
    );
  }
}

function showNotice(text,color){
  const n=document.createElement("div");
  n.className="notice";
  n.style.color=color;
  n.textContent=text;
  canvas.appendChild(n);
  setTimeout(()=>n.remove(),1000);
}

/* ===== END GAME ===== */
function endGame(){
  active=false;
  input.disabled=true;

  const wpm=Math.round((correctChars/5)/3);
  document.getElementById("finalWpm").textContent=wpm+" WPM";

  document.getElementById("finalMsg").textContent=
    wpm<40
      ?"Below target. Aim for 40–80 WPM."
      :wpm<=80
        ?"On target. Good typing speed."
        :"Excellent speed!";

  document.getElementById("end").style.display="flex";
}
</script>

</body>
</html>

