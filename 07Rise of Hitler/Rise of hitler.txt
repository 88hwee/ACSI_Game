<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Rise of Hitler ‚Äì Drag-and-Drop Timeline</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
      background: linear-gradient(135deg, #1f3a93, #2c3e50);
      min-height: 100vh;
      color: #222;
      display: flex;
      flex-direction: column;
    }

    header {
      color: #fff;
      padding: 1.5rem 1rem;
      box-shadow: 0 3px 8px rgba(0,0,0,0.3);
    }

    .header-inner {
      max-width: 1100px;
      margin: 0 auto;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 0.75rem;
    }

    .header-text {
      flex: 1 1 260px;
    }

    header h1 {
      margin: 0 0 .4rem;
      font-size: 1.8rem;
    }

    header p {
      margin: 0;
      opacity: 0.9;
      font-size: 0.95rem;
    }

    .timer-badge {
      font-size: 0.9rem;
      font-weight: 600;
      background: rgba(0,0,0,0.22);
      border-radius: 999px;
      padding: 0.35rem 0.9rem;
      white-space: nowrap;
      box-shadow: 0 2px 5px rgba(0,0,0,0.25);
    }

    main {
      flex: 1;
      padding: 1rem;
      max-width: 1100px;
      width: 100%;
      margin: 0 auto 1rem;
    }

    .layout {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    @media (min-width: 900px) {
      .layout {
        flex-direction: row;
        align-items: flex-start;
      }
    }

    .panel {
      background: #f5f7fb;
      border-radius: 10px;
      padding: 1rem;
      box-shadow: 0 2px 6px rgba(0,0,0,0.12);
    }

    .panel h2 {
      margin: 0 0 .5rem;
      font-size: 1.1rem;
      color: #1a2a4a;
    }

    .panel p {
      margin: 0 0 .5rem;
      font-size: 0.9rem;
    }

    /* Card pool */
    #card-pool {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      min-height: 150px;
      border-radius: 8px;
      padding: 0.5rem;
      background: #e8edf8;
      border: 2px dashed rgba(26,42,74,0.3);
    }

    .card {
      background: #fff;
      border-radius: 8px;
      padding: 0.4rem 0.5rem;
      width: 100%;
      max-width: 260px;
      font-size: 0.9rem;
      cursor: grab;
      border: 1px solid #ccd4eb;
      box-shadow: 0 2px 4px rgba(0,0,0,0.07);
      transition: transform 0.1s, box-shadow 0.1s, background 0.1s;
    }

    .card strong {
      display: inline-block;
      margin-right: 0.3rem;
      color: #1a2a4a;
    }

    .card.dragging {
      opacity: 0.8;
      transform: scale(1.03);
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      cursor: grabbing;
    }

    /* Timeline */
    .timeline-wrapper {
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
    }

    .timeline-row {
      display: grid;
      grid-template-columns: 42px 1fr;
      gap: 0.5rem;
      align-items: stretch;
    }

    .position-label {
      display: flex;
      align-items: center;
      justify-content: center;
      background: #1f3a93;
      color: #fff;
      font-weight: 600;
      border-radius: 8px;
      font-size: 0.9rem;
      min-height: 48px;
    }

    .slot {
      min-height: 48px;
      background: #eef2ff;
      border-radius: 8px;
      border: 2px dashed rgba(31,58,147,0.35);
      padding: 0.2rem;
      display: flex;
      align-items: stretch;
      justify-content: flex-start;
      transition: background 0.15s, border-color 0.15s, box-shadow 0.15s;
    }

    .slot.highlight {
      background: #dde6ff;
      border-color: #1f3a93;
      box-shadow: 0 0 0 2px rgba(31,58,147,0.2);
    }

    .slot.correct {
      background: #e3f9e5;
      border-color: #2e7d32;
    }

    .slot.incorrect {
      background: #ffebee;
      border-color: #c62828;
    }

    .slot.empty-warning {
      background: #fff8e1;
      border-color: #f9a825;
    }

    .slot .card {
      margin: 0;
      width: 100%;
      max-width: none;
    }

    /* Controls + feedback */
    .controls {
      margin-top: 0.6rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      align-items: center;
      justify-content: flex-start;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 0.45rem 0.9rem;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      background: #1f3a93;
      color: #fff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.18);
      transition: background 0.15s, transform 0.1s, box-shadow 0.1s;
    }

    button.secondary {
      background: #6c757d;
    }

    button:hover {
      background: #162b6b;
      transform: translateY(-1px);
      box-shadow: 0 3px 7px rgba(0,0,0,0.25);
    }

    button.secondary:hover {
      background: #545b62;
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      box-shadow: none;
      transform: none;
    }

    #feedback {
      font-size: 0.9rem;
      margin-left: 0.5rem;
      min-height: 1.2rem;
    }

    #feedback.good {
      color: #1b5e20;
    }

    #feedback.ok {
      color: #f57f17;
    }

    #feedback.bad {
      color: #b71c1c;
    }

    footer {
      text-align: center;
      color: #e0e4ff;
      font-size: 0.75rem;
      padding-bottom: 0.5rem;
      opacity: 0.75;
    }

    /* When time is up, visually dim the play area */
    .time-up #card-pool,
    .time-up .slot {
      opacity: 0.6;
    }
  </style>
</head>
<body>
  <header>
    <div class="header-inner">
      <div class="header-text">
        <h1>Rise of Hitler ‚Äì Drag-and-Drop Timeline</h1>
        <p>Drag the events into the correct chronological order (1 = earliest, 12 = latest), then click ‚ÄúCheck Order‚Äù.</p>
      </div>
      <!-- Timer now set to 3 minutes -->
      <div id="timer" class="timer-badge">‚è± Time left: 03:00</div>
    </div>
  </header>

  <main>
    <div class="layout">
      <!-- Left: card pool -->
      <section class="panel" style="flex:1;">
        <h2>Event Cards</h2>
        <p>Pick up a card and drop it into a numbered slot on the right. You can move cards around anytime.</p>
        <div id="card-pool" data-drop-target="pool">
          <!-- Cards will be added here by JavaScript -->
        </div>
      </section>

      <!-- Right: timeline -->
      <section class="panel" style="flex:1.2;">
        <h2>Timeline Slots</h2>
        <p>1 = earliest event, 12 = latest event in Hitler‚Äôs rise to power.</p>
        <div class="timeline-wrapper" id="timeline">
          <!-- Slots (1‚Äì12) -->
        </div>
        <div class="controls">
          <button id="check-btn">Check Order</button>
          <button id="reset-btn" class="secondary">Reset &amp; Shuffle</button>
          <div id="feedback"></div>
        </div>
      </section>
    </div>
  </main>

  <footer>
    Rise of Hitler timeline: from early party days to becoming F√ºhrer in 1934.
  </footer>

  <script>
    // ===== SETTINGS =====
    const TOTAL_TIME_SECONDS = 3 * 60; // 3 minutes

    // Data for the events in correct chronological order
    const eventsData = [
      {
        id: "e1",
        year: "1919",
        text: "Hitler joins the German Workers' Party (DAP)."
      },
      {
        id: "e2",
        year: "1920",
        text: "DAP becomes NSDAP (Nazi Party) and announces the 25-point programme."
      },
      {
        id: "e3",
        year: "1923",
        text: "Munich Putsch fails; Hitler is arrested after the attempted takeover in Bavaria."
      },
      {
        id: "e4",
        year: "1924‚Äì1925",
        text: "Hitler writes <em>Mein Kampf</em> in prison and rebuilds the Nazi Party legally after his release."
      },
      {
        id: "e5",
        year: "1928",
        text: "Nazi Party wins only 2.6% of the vote in Reichstag elections."
      },
      {
        id: "e6",
        year: "1929",
        text: "Wall Street Crash; Great Depression hits Germany, causing mass unemployment."
      },
      {
        id: "e7",
        year: "July 1932",
        text: "Nazis become the largest party in the Reichstag but Hitler is not yet Chancellor."
      },
      {
        id: "e8",
        year: "30 Jan 1933",
        text: "Hindenburg appoints Hitler as Chancellor after backstairs political deals."
      },
      {
        id: "e9",
        year: "27 Feb 1933",
        text: "Reichstag Fire; emergency powers used to arrest communists and opponents."
      },
      {
        id: "e10",
        year: "23 Mar 1933",
        text: "Enabling Act passed, allowing Hitler to make laws without the Reichstag."
      },
      {
        id: "e11",
        year: "30 June 1934",
        text: "Night of the Long Knives; SA leaders and rivals are purged."
      },
      {
        id: "e12",
        year: "Aug 1934",
        text: "President Hindenburg dies; Hitler combines Chancellor and President to become F√ºhrer."
      }
    ];

    const correctOrderIds = eventsData.map(e => e.id);

    const cardPool = document.getElementById("card-pool");
    const timeline = document.getElementById("timeline");
    const checkBtn = document.getElementById("check-btn");
    const resetBtn = document.getElementById("reset-btn");
    const feedback = document.getElementById("feedback");
    const timerDisplay = document.getElementById("timer");

    let draggedCard = null;
    let timeRemaining = TOTAL_TIME_SECONDS;
    let timerInterval = null;
    let timeUp = false;

    function createSlots() {
      // Create 12 slots with position labels
      for (let i = 0; i < correctOrderIds.length; i++) {
        const row = document.createElement("div");
        row.className = "timeline-row";

        const label = document.createElement("div");
        label.className = "position-label";
        label.textContent = i + 1;

        const slot = document.createElement("div");
        slot.className = "slot";
        slot.dataset.position = i;
        slot.dataset.dropTarget = "slot";

        addDropListeners(slot);

        row.appendChild(label);
        row.appendChild(slot);
        timeline.appendChild(row);
      }
    }

    function createCard(eventObj) {
      const card = document.createElement("div");
      card.className = "card";
      card.draggable = true;
      card.dataset.id = eventObj.id;
      card.innerHTML = `<strong>${eventObj.year}:</strong> ${eventObj.text}`;

      card.addEventListener("dragstart", (e) => {
        if (timeUp) {
          e.preventDefault();
          return;
        }
        draggedCard = card;
        card.classList.add("dragging");
      });

      card.addEventListener("dragend", () => {
        draggedCard = null;
        card.classList.remove("dragging");
      });

      return card;
    }

    function addDropListeners(el) {
      el.addEventListener("dragover", (e) => {
        if (timeUp) return;
        e.preventDefault(); // allow drop
        if (el.classList.contains("slot")) {
          el.classList.add("highlight");
        }
      });

      el.addEventListener("dragleave", () => {
        if (el.classList.contains("slot")) {
          el.classList.remove("highlight");
        }
      });

      el.addEventListener("drop", (e) => {
        if (timeUp) return;
        e.preventDefault();
        if (!draggedCard) return;

        if (el.dataset.dropTarget === "slot") {
          el.classList.remove("highlight");
          clearResultClasses(el);

          // If slot already has a card, send it back to pool
          const existingCard = el.querySelector(".card");
          if (existingCard) {
            cardPool.appendChild(existingCard);
          }
          el.appendChild(draggedCard);
        } else if (el.dataset.dropTarget === "pool") {
          // Dropping back into pool
          cardPool.appendChild(draggedCard);
        }

        // Clear previous feedback when things change
        clearAllSlotResults();
        setFeedback("");
      });
    }

    function shuffleArray(arr) {
      const array = arr.slice();
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function initCards() {
      cardPool.innerHTML = "";
      const shuffled = shuffleArray(eventsData);
      shuffled.forEach(ev => {
        const card = createCard(ev);
        cardPool.appendChild(card);
      });
    }

    function clearResultClasses(slot) {
      slot.classList.remove("correct", "incorrect", "empty-warning");
    }

    function clearAllSlotResults() {
      const slots = document.querySelectorAll(".slot");
      slots.forEach(slot => {
        slot.classList.remove("correct", "incorrect", "empty-warning");
      });
    }

    function setFeedback(message, type) {
      feedback.textContent = message;
      feedback.classList.remove("good", "ok", "bad");
      if (type) feedback.classList.add(type);
    }

    function checkOrder() {
      if (timeUp) return;

      const slots = document.querySelectorAll(".slot");
      let correctCount = 0;
      let filledCount = 0;

      slots.forEach((slot, index) => {
        clearResultClasses(slot);
        const card = slot.querySelector(".card");
        if (!card) {
          // empty slot
          slot.classList.add("empty-warning");
          return;
        }
        filledCount++;

        const cardId = card.dataset.id;
        if (cardId === correctOrderIds[index]) {
          slot.classList.add("correct");
          correctCount++;
        } else {
          slot.classList.add("incorrect");
        }
      });

      if (filledCount < correctOrderIds.length) {
        setFeedback(
          `You placed ${filledCount}/${correctOrderIds.length} cards. Fill all slots, then check again.`,
          "bad"
        );
        return;
      }

      if (correctCount === correctOrderIds.length) {
        setFeedback(
          `Perfect! All ${correctCount}/${correctOrderIds.length} events are in the correct order. üéâ`,
          "good"
        );
      } else if (correctCount >= 8) {
        setFeedback(
          `Nice work! You got ${correctCount}/${correctOrderIds.length} in the correct place. Adjust the red ones.`,
          "ok"
        );
      } else {
        setFeedback(
          `You got ${correctCount}/${correctOrderIds.length} correct. Try moving the red cards ‚Äì think about long-term vs short-term events.`,
          "bad"
        );
      }
    }

    function resetAll() {
      // Move any cards from slots back to pool
      const slots = document.querySelectorAll(".slot");
      slots.forEach(slot => {
        clearResultClasses(slot);
        const card = slot.querySelector(".card");
        if (card) {
          cardPool.appendChild(card);
        }
      });
      clearAllSlotResults();
      setFeedback("");

      // NOTE: Reset does NOT restart the timer; refresh the page for a new timed round.
      initCards();
    }

    // ===== TIMER FUNCTIONS =====
    function formatTime(seconds) {
      const m = Math.floor(seconds / 60);
      const s = seconds % 60;
      const mm = m < 10 ? "0" + m : m;
      const ss = s < 10 ? "0" + s : s;
      return `${mm}:${ss}`;
    }

    function updateTimerDisplay() {
      timerDisplay.textContent = `‚è± Time left: ${formatTime(timeRemaining)}`;
    }

    function startTimer() {
      updateTimerDisplay();
      timerInterval = setInterval(() => {
        timeRemaining--;
        if (timeRemaining <= 0) {
          timeRemaining = 0;
          updateTimerDisplay();
          handleTimeUp();
          clearInterval(timerInterval);
        } else {
          updateTimerDisplay();
        }
      }, 1000);
    }

    function handleTimeUp() {
      timeUp = true;
      document.body.classList.add("time-up");
      setFeedback(
        "Time's up! You can still view your work, but checking and dragging are disabled.",
        "bad"
      );

      // Disable check button
      checkBtn.disabled = true;

      // Disable dragging for all cards
      document.querySelectorAll(".card").forEach(card => {
        card.draggable = false;
      });

      // Block pointer events for card pool and slots (to stop drops)
      cardPool.style.pointerEvents = "none";
      document.querySelectorAll(".slot").forEach(slot => {
        slot.style.pointerEvents = "none";
      });

      // Highlight timer text
      timerDisplay.textContent = "‚è± Time's up!";
    }

    // Initial set-up
    document.addEventListener("DOMContentLoaded", () => {
      createSlots();
      addDropListeners(cardPool);
      initCards();

      checkBtn.addEventListener("click", checkOrder);
      resetBtn.addEventListener("click", resetAll);

      startTimer();
    });
  </script>
</body>
</html>
